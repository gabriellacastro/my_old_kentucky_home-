
<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8" />
<title></title>
<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>

<h1 id="title"></h1>

<video src="https://www.cs.tufts.edu/comp/20/my_old_kentucky_home.mp4" id="music_video" controls></video>
<div id="lyrics"></div>

<script>

stanza1 = "<p>The sun shines bright in My Old Kentucky Home,<br>'Tis summer, the people are gay;<br>The corn-top's ripe and the meadow's in the bloom<br> While the birds make music all the day.</p>";

stanza2 = "<p>The young folks roll on the little cabin floor,<br> All merry, all happy and bright;<br> By 'n' by hard times comes a knocking at the door,<br> Then My Old Kentucky Home, good night!</p>";

chorus = "<p>Weep no more my lady<br> Oh weep no more today;<br> We will sing one song<br> For My Old Kentucky Home <br> For My Old Kentucky Home, far away</p>";

stanzas = [stanza1, stanza2, chorus];

document.addEventListener("DOMContentLoaded", function(){

	var video = document.getElementById("music_video");

	video.addEventListener("play", function(){ //listen for playback event
		annotate_video(video); //call function to annotate video
	});
});

function annotate_video(vid) {

	var body = document.body;
	var title = document.getElementById("title");

	var background_div = document.createElement("div");
	background_div.className = "background-img";

	var lyrics = document.getElementById("lyrics");

	var img1_inserted = false;
	var img1_class = " meadow_sunrise";
	var img2_inserted = false;
	var img2_class = " farm";
	var img3_inserted = false;
	var img3_class = " meadow_dusk";

	vid.addEventListener("timeupdate", function(){
		if(vid.currentTime > 63) {
			if(!img3_inserted) {
				img3_inserted = insertImg(img3_class);
				lyrics.innerHTML = "<div class='stanza'>" + stanzas[2]; + "</div>";
			}
		}
		else if(vid.currentTime > 36) {
			if(!img2_inserted) {
				img2_inserted = insertImg(img2_class);
				lyrics.innerHTML = "<div class='stanza'>" + stanzas[1]; + "</div>";
			}

		}
		else if(vid.currentTime > 8) {
			if(!img1_inserted) {
				img1_inserted = insertImg(img1_class);
				lyrics.innerHTML = "<div class='stanza'>" + stanzas[0] + "</div>";
			}
		}

	});

	vid.addEventListener("ended", function(){
		clearBackgroundAtEnd(); //remove background image
		lyrics.innerHTML = ""; //remove lyrics
	});

	function insertImg(img_class) {

		background_div.className += img_class;
		body.insertBefore(background_div, title); //insert background div after open body tag

		return true;
	}

	function clearBackgroundAtEnd() {
		background_div.className = "";
	}



}
</script>
</body>
</html>	
